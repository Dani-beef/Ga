(function(e){"use strict";e.fn.extend({maxlength:function(t,n){function s(e){var n=e.val();n=n.replace(new RegExp("\r?\n","g"),"\n");var r=0;if(t.utf8){r=o(e.val())}else{r=e.val().length}return r}function o(e){var t=0;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t++}else if(r>127&&r<2048){t=t+2}else{t=t+3}}return t}function u(e,n,r){var i=true;if(!t.alwaysShow&&r-s(e)>n){i=false}return i}function a(e,t){var n=t-s(e);return n}function f(e){e.css({display:"block"})}function l(e){e.css({display:"none"})}function c(e,n){var r="";if(t.message){r=t.message.replace("%charsTyped%",n).replace("%charsRemaining%",e-n).replace("%charsTotal%",e)}else{if(t.preText){r+=t.preText}if(!t.showCharsTyped){r+=e-n}else{r+=n}if(t.showMaxLength){r+=t.separator+e}if(t.postText){r+=t.postText}}return r}function h(e,n,r,i){i.html(c(r,r-e));if(e>0){if(u(n,t.threshold,r)){f(i.removeClass(t.limitReachedClass).addClass(t.warningClass))}else{l(i)}}else{f(i.removeClass(t.warningClass).addClass(t.limitReachedClass))}}function p(t){var n=t[0];return e.extend({},typeof n.getBoundingClientRect==="function"?n.getBoundingClientRect():{width:n.offsetWidth,height:n.offsetHeight},t.offset())}function d(n,r){if(e(r).length){var i=p(n),s=n.outerWidth(),o=r.outerWidth(),u=r.width(),a=r.height();switch(t.placement){case"bottom":r.css({top:i.top+i.height+5,left:i.left+i.width/2-u/2});break;case"top":r.css({top:i.top-a-5,left:i.left+i.width/2-u/2});break;case"left":r.css({top:i.top+i.height/2-a/2,left:i.left-u-5});break;case"right":r.css({top:i.top+i.height/2-a/2,left:i.left+i.width+5});break;case"bottom-right":r.css({top:i.top+i.height,left:i.left+i.width});break;case"top-right":r.css({top:i.top-a,left:i.left+s});break;case"top-left":r.css({top:i.top-a,left:i.left-o});break;case"bottom-left":r.css({top:i.top+n.outerHeight(),left:i.left-o});break;case"centered-right":r.css({top:i.top+a/2,left:i.left+s-o-3});break}}}function v(e){return e.attr("maxlength")||e.attr("size")}var r=e("body"),i={alwaysShow:false,threshold:10,warningClass:"label label-success",limitReachedClass:"label label-important",separator:" / ",preText:"",postText:"",showMaxLength:true,placement:"bottom",showCharsTyped:true,validate:false,utf8:false};if(e.isFunction(t)&&!n){n=t;t={}}t=e.extend(i,t);t.placement=e(this).attr("data-maxlength-position")?e(this).attr("data-maxlength-position"):t.placement;return this.each(function(){var n=e(this),i,s;e(window).resize(function(){d(n,s)});n.focus(function(){var t=c(i,"0");i=v(n);if(!s){s=e('<span class="bootstrap-maxlength"></span>').css({display:"none",position:"absolute",whiteSpace:"nowrap",zIndex:1099}).html(t)}if(n.is("textarea")){n.data("maxlenghtsizex",n.outerWidth());n.data("maxlenghtsizey",n.outerHeight());n.mouseup(function(){if(n.outerWidth()!==n.data("maxlenghtsizex")||n.outerHeight()!==n.data("maxlenghtsizey")){d(n,s)}n.data("maxlenghtsizex",n.outerWidth());n.data("maxlenghtsizey",n.outerHeight())})}r.append(s);var o=a(n,v(n));h(o,n,i,s);d(n,s)});n.blur(function(){s.remove()});n.keyup(function(){var e=a(n,v(n)),r=true;if(t.validate&&e<0){r=false}else{h(e,n,i,s)}return r})})}})})(jQuery)